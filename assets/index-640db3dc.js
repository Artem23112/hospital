import{c as Q,a as S,v as O,l,h as y,g,u as it,r as _,o as Z,b as $,s as A,A as N,d as ue,e as M,f as pe,i as me,j as he,k as _e,m as fe,n as s,p as f,N as J,q as xe,L as lt,t as u,w as ge,R as vt,x as R,y as be,_ as je,z as dt,B as Se,C as ye,D as we,E as Dt,F as It,G as Nt,H as Ct,I as ve,J as De,K as Ie,M as Ne,P as Ce,O as $e}from"./.pnpm-3bc1224a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const $t="/assets/close-a79845a6.svg",Pe={error:"Ошибка",success:"Успех",warning:"Предупреждение",information:"Информация"},Ae=[],Pt=Q({name:"popup-messages",initialState:Ae,reducers:{addMessage(e,t){e.push(t.payload)},removeMessage(e,t){return e.filter(n=>n.id!==t.payload)}}}),E=S("popup-messages/show",async(e,{dispatch:t})=>{const n={...e,id:O()};t(Te(n)),await new Promise(r=>{(n==null?void 0:n.duration)!==0&&setTimeout(()=>{t(At(n.id)),r("success")},(n==null?void 0:n.duration)||3e3)})}),{addMessage:Te,removeMessage:At}=Pt.actions,ke=Pt.reducer,Tt=e=>l.Intersect(e,l.Record({id:l.String})),Re=l.Union(l.Literal("enrolled"),l.Literal("admitted"),l.Literal("not-admitted"),l.Literal("expired")),kt=l.Record({status:Re,fullDateISO:l.String}),Ee=l.Record({patientId:l.String,fullDateISO:l.String,record:l.String,doctorId:l.String}),Rt=l.Dictionary(Ee,l.String),Et=l.Record({name:l.String,specialization:l.String,additional:l.Record({education:l.String,experience:l.String})}),Le=Tt(Et),Lt=l.Dictionary(Et,l.String),Oe=l.Intersect(kt,l.Record({userId:l.String})),ut=l.Dictionary(Oe,l.String),Me=l.Dictionary(l.Boolean,l.String),Ot=async(e,t,n)=>{e.forEach(r=>{if(y(r.fullDateISO).isBefore(y())&&r.status==="enrolled"){const a=g(),o=`${n==="admin"?"doctors":"users"}/${t}/appointments/${r.id}/`;it(_(a,o),{status:"expired"})}})},D=e=>e instanceof Object?Object.entries(e).map(([n,r])=>({id:n,...r})):[],Mt=e=>e.sort((t,n)=>t.fullDateISO.localeCompare(n.fullDateISO));function Fe(e,t){const n=_(g(),`doctors/${t}/appointments`);Z(n,async r=>{const a=r.val();if(!ut.guard(a))return;const o=D(a);await Ot(o,t,"admin");const i=Mt(o);e(Ye(i))})}function Be(e,t){const n=_(g(),`doctors/${t}/my-patients`);Z(n,async r=>{const a=r.val();if(!Me.guard(a))return;const o=Object.keys(a);e(Ke(o))})}const Ft=l.Record({name:l.String}),Ue=Tt(Ft),He=l.Dictionary(Ft,l.String),qe=l.Intersect(kt,l.Record({doctorId:l.String})),ze=l.Dictionary(qe,l.String),Bt=S("doctorSlice/doctorConnectToServer",async(e,{dispatch:t,rejectWithValue:n})=>{Fe(t,e),Be(t,e);const r=_(g(),"users-info"),a=(await $(r)).val();if(!He.guard(a))return n("unknown type info about users");const o=_(g(),"doctors-info"),i=(await $(o)).val();return Lt.guard(i)?{usersInfo:D(a),doctorsInfo:D(i)}:n("")}),L=S("doctorSlice/getMedicalCard",async(e,{rejectWithValue:t})=>{const n=g(),r=_(n,`users-info/${e}/medical-records`);try{const a=await $(r),o=a.val();if(!a.exists()||!Rt.guard(o))throw Error();return D(o)}catch{return t("")}}),We={appointments:[],usersInfo:[],doctorsInfo:[],doctorPatients:[],medicalCard:[],isLoading:!1},Ut=Q({name:"doctorSlice",initialState:We,reducers:{setDoctorAppointments(e,t){e.appointments=t.payload},setDoctorPatients(e,t){e.doctorPatients=t.payload}},extraReducers:e=>{e.addCase(Bt.fulfilled,(t,n)=>{t.usersInfo=n.payload.usersInfo,t.doctorsInfo=n.payload.doctorsInfo}).addCase(L.pending,t=>{t.isLoading=!0}).addCase(L.fulfilled,(t,n)=>{t.medicalCard=n.payload,t.isLoading=!1}).addCase(L.rejected,t=>{t.medicalCard=[],t.isLoading=!1})}}),{setDoctorAppointments:Ye,setDoctorPatients:Ke}=Ut.actions,Ve=Ut.reducer,Ht=S("patientSlice/getMedicalCard",async(e,{rejectWithValue:t,getState:n})=>{const r=g(),o=n().authentication.id,i=_(r,`users-info/${o}/medical-records`);try{const c=await $(i),d=c.val();if(!c.exists()||!Rt.guard(d))throw Error();return D(d)}catch{return t("")}}),Ge=async e=>{const t=g(),n=_(t,`doctors/${e}/appointments`),r=await $(n),a=r.val();if(!r.exists())return[];if(!ut.guard(a))throw new Error("unknown type of doctor appointment data");return D(a).map(c=>c.fullDateISO)},Qe=async(e,t)=>({isExists:(await Ge(e)).some(a=>a===t)}),Ze=(e,t)=>{const n=y(t,"HH:mm");return y(e).hours(n.hours()).minutes(n.minutes()).seconds(0).milliseconds(0).toISOString()},qt=S("patientSlice/sendApplication",async(e,{getState:t,dispatch:n,rejectWithValue:r})=>{const a=t(),{chosenDoctor:o,chosenDate:i,chosenTime:c}=a.patientSlice.appointmentData;if(!o||!i||!c)return n(E({text:"Извините, но вы выбрали не все, что необходимо для записи",type:"warning"})),r("Данных недостаточно");const d=g(),b=Ze(i,c),h=a.authentication.id,I={status:"enrolled",fullDateISO:b},B=O(),tt=_(d,`doctors/${o}/appointments/${B}`),et=_(d,`users/${h}/appointments/${B}`);try{const{isExists:st}=await Qe(o,b);if(st)throw new Error("Запись на данное число уже есть");A(tt,{...I,userId:h}),A(et,{...I,doctorId:o}),n(E({text:"Вы записались к врачу",type:"success"}))}catch(st){const de=st.message||"Упс, что-то пошло не так, записаться не удалось";return n(E({text:de,type:"error"})),r("")}}),Je={userAppointments:[],doctorsInfo:[],usersInfo:[],isSuccessSubmit:!1,busyDates:[],appointmentData:{chosenDoctor:null,chosenDate:null,chosenTime:null},medicalRecords:[]},zt=Q({name:"patientSlice",initialState:Je,reducers:{setPatientAppointments(e,t){e.userAppointments=t.payload},setBusyDates(e,t){e.busyDates=t.payload},clearSubmitStatus(e){e.isSuccessSubmit=!1},setChosenAppointmentData(e,t){e.appointmentData={...e.appointmentData,...t.payload}}},extraReducers:e=>{e.addCase(mt.fulfilled,(t,n)=>{t.doctorsInfo=n.payload}).addCase(qt.fulfilled,t=>{t.isSuccessSubmit=!0,t.appointmentData={chosenDoctor:null,chosenDate:null,chosenTime:null}}).addCase(Ht.fulfilled,(t,n)=>{t.medicalRecords=n.payload})}}),Wt=e=>e.patientSlice.doctorsInfo,Xe=e=>e.patientSlice.isSuccessSubmit,ts=e=>e.patientSlice.busyDates,es=e=>e.patientSlice.appointmentData.chosenDoctor,Yt=e=>e.patientSlice.appointmentData.chosenDate,ss=e=>e.patientSlice.appointmentData.chosenTime,{setPatientAppointments:ns,clearSubmitStatus:rs,setBusyDates:ft,setChosenAppointmentData:pt}=zt.actions,as=zt.reducer;function os(e,t){const n=_(g(),`users/${t}/appointments`);Z(n,async r=>{const a=r.val();if(!ze.guard(a))return;const o=D(a);await Ot(o,t,"user");const i=Mt(o);e(ns(i))})}const mt=S("patientSlice/patientConnectToServer",async(e,{dispatch:t,rejectWithValue:n})=>{os(t,e),t(Ht());const r=_(g(),"doctors-info"),a=(await $(r)).val();return Lt.guard(a)?D(a):n("unknown type info about doctors")}),V=S("authentication/connect",async(e,{dispatch:t,rejectWithValue:n,getState:r})=>{try{const o=r().authentication.id;if(!o)throw new Error("Пользователь не авторизован");return(await $(_(g(),`doctors-info/${o}`))).exists()?(t(Bt(o)),"admin"):(t(mt(o)),"user")}catch(a){return n(a.code)}}),ht=e=>{switch(e){case N.INVALID_EMAIL:return{type:"email-error",message:"Неверный формат email."};case N.EMAIL_EXISTS:return{type:"email-error",message:"Email уже используется другим пользователем."};case N.USER_DELETED:return{type:"email-error",message:"Пользователь с указанным email не найден."};case N.USER_DISABLED:return{type:"email-error",message:"Учетная запись пользователя отключена."};case N.WEAK_PASSWORD:return{type:"pw-error",message:"Слабый пароль."};case N.INVALID_PASSWORD:return{type:"pw-error",message:"Неверный пароль."};case N.NETWORK_REQUEST_FAILED:return{type:"error",message:"Кажется какие-то проблемы с сетью."};case N.TOO_MANY_ATTEMPTS_TRY_LATER:return{type:"error",message:"Сервер слишком нагружен, попробуйте позже."};case null:return{type:null,message:null};default:return{type:"error",message:"Извините произошла какая-то ошибка, перезагрузите страницу"}}},W=S("authentication/exit",async(e,{rejectWithValue:t})=>{try{await ue(M())}catch(n){return t({...ht(n.code)})}}),Y=S("authentication/signIn",async({email:e,password:t},{rejectWithValue:n,dispatch:r})=>{try{const{user:a}=await pe(M(),e,t);return r(V()),{email:a.email,id:a.uid}}catch(a){return n({error:ht(a.code)})}}),K=S("authentication/signUp",async({email:e,password:t,name:n},{rejectWithValue:r,dispatch:a})=>{try{const{user:o}=await me(M(),e,t),i=o.uid;return await A(_(g(),`users-info/${i}/rights`),"user"),await A(_(g(),`users-info/${i}/name`),n),a(mt(i)),{email:o.email,id:i}}catch(o){return r({error:{...ht(o.code),page:"/signup"}})}}),is={email:null,id:null,isAuth:!1,rights:null,loading:!1,error:null},Kt=Q({name:"authentication",initialState:is,reducers:{setSavedUser(e,t){const{email:n,id:r,isAuth:a}=t.payload;e.error=null,e.email=n,e.id=r,e.isAuth=a},clearError(e){e.error=null}},extraReducers:e=>{e.addCase(K.fulfilled,(t,n)=>{const{email:r,id:a}=n.payload;t.email=r,t.id=a,t.isAuth=!0,t.loading=!1,t.error=null}).addCase(Y.fulfilled,(t,n)=>{const{email:r,id:a}=n.payload;t.email=r,t.id=a,t.isAuth=!0,t.loading=!1,t.error=null}).addCase(W.fulfilled,t=>{t.email=null,t.id=null,t.isAuth=!1,t.rights=null,t.loading=!1,t.error=null}).addCase(V.fulfilled,(t,n)=>{t.rights=n.payload}).addMatcher(t=>t.type===K.pending.type||t.type===Y.pending.type||t.type===W.pending.type,t=>{t.loading=!0}).addMatcher(t=>t.type===K.rejected.type||t.type===Y.rejected.type||t.type===W.rejected.type||t.type===V.rejected.type,(t,n)=>{t.error=n.payload.error,t.loading=!1})}}),Vt=e=>e.authentication.loading,Gt=e=>e.authentication.error,{setSavedUser:cs,clearError:Qt}=Kt.actions,ls=Kt.reducer,ds=he({reducer:{authentication:ls,doctorSlice:Ve,patientSlice:as,popupMessage:ke},devTools:!0}),w=_e,p=fe,us="_title_xtytf_14",ps="_error_xtytf_25",ms="_warning_xtytf_29",hs="_success_xtytf_33",_s="_information_xtytf_37",U={"popup-message":"_popup-message_xtytf_3",title:us,"close-btn":"_close-btn_xtytf_19",error:ps,warning:ms,success:hs,information:_s},fs=({type:e,text:t,id:n})=>{const r=w();return s.jsxs("div",{className:f(U[e],U["popup-message"]),children:[s.jsxs("div",{children:[s.jsx("h4",{className:U.title,children:Pe[e]}),s.jsx("p",{children:t})]}),s.jsx("button",{className:U["close-btn"],type:"button",onClick:()=>{r(At(n))},children:s.jsx("img",{src:$t})})]})},xs={"messages-wrapper":"_messages-wrapper_su4a9_1"},gs=()=>{const e=p(t=>t.popupMessage);return s.jsx("div",{className:xs["messages-wrapper"],children:e.map(t=>s.jsx(fs,{type:t.type,text:t.text,id:t.id},t.id))})},Zt=({children:e})=>p(n=>n.authentication.isAuth)?s.jsx(s.Fragment,{children:e}):s.jsx(J,{to:"/login"}),bs=e=>xe(M(),n=>{n&&(e(cs({email:n.email,id:n.uid,isAuth:!0})),e(V()))}),js="_wrapper_1e9ia_3",Ss={wrapper:js},Jt=({contentText:e,linkText:t,redirectPath:n,handleClick:r})=>s.jsxs("p",{className:Ss.wrapper,children:[e,s.jsx(lt,{to:n,onClick:r,children:t})]}),ys="_btn_15hr8_10",ws="_input_15hr8_27",vs="_err_15hr8_3",nt={"err-message":"_err-message_15hr8_3",btn:ys,input:ws,err:vs},ct=({className:e,isError:t,errMessage:n,...r})=>s.jsxs("label",{children:[t&&s.jsx("span",{className:nt["err-message"],children:n}),s.jsx("input",{className:f(nt.input,{[nt.err]:t},e),...r})]}),Ds="_form_1stak_3",Is="_btn_1stak_9",Ns={form:Ds,btn:Is},Xt=({children:e,submitBtnContent:t,submitHandler:n,error:r})=>{const[a,o]=u.useState(""),[i,c]=u.useState(""),d=(r==null?void 0:r.type)==="email-error",b=(r==null?void 0:r.type)==="pw-error";return s.jsxs("form",{onSubmit:h=>{h.preventDefault(),n(a,i)},children:[e,s.jsx(ct,{type:"email",value:a,onChange:h=>o(h.target.value),placeholder:"Логин",isError:d,errMessage:r==null?void 0:r.message,required:!0}),s.jsx(ct,{type:"password",value:i,onChange:h=>c(h.target.value),placeholder:"Пароль",isError:b,errMessage:r==null?void 0:r.message,required:!0}),s.jsx("button",{className:Ns.btn,type:"submit",children:t})]})},Cs="_loader_1gmtn_3",$s="_rotation_1gmtn_1",Ps={loader:Cs,rotation:$s},_t=({size:e,color:t})=>{const n={width:`${e}px`,height:`${e}px`,borderWidth:`${Math.floor(e/10)}px`,borderColor:t,borderBottomColor:"transparent"};return s.jsx("span",{className:Ps.loader,style:n})},As="_container_pbous_3",Ts={container:As},F=({children:e,className:t})=>s.jsx("div",{className:f(Ts.container,t),children:e}),m={home:"/",login:"/login",singUp:"/signup",profile:{home:"/profile/",makeAppointment:"make-appointment/",appointmentList:"appointment-list/",myPatients:"my-patients/"}},ks="_title_hrqi1_16",xt={"login-wrapper":"_login-wrapper_hrqi1_3",title:ks,"err-message":"_err-message_hrqi1_23"},Rs=()=>{const e=w(),t=p(Vt),n=p(Gt);function r(a,o){e(Y({email:a,password:o}))}return s.jsx(F,{children:s.jsxs("div",{className:xt["login-wrapper"],children:[s.jsx("h3",{className:xt.title,children:"Вход в аккаунт"}),s.jsx(Xt,{submitBtnContent:t?s.jsx(_t,{size:24,color:"#fff"}):"Войти",submitHandler:r,error:n}),s.jsx(Jt,{contentText:"Нет аккаунта?",linkText:"Регистрация",redirectPath:m.singUp,handleClick:()=>e(Qt())})]})})},G=({requiredRights:e,children:t})=>{const n=p(r=>r.authentication.rights);return s.jsx(s.Fragment,{children:e===n&&s.jsx(s.Fragment,{children:t})})},Es="_tab_1uvki_3",Ls="_active_1uvki_12",Os="_shadow_1uvki_34",H={"tab-list":"_tab-list_1uvki_3",tab:Es,active:Ls,shadow:Os},te=({tabsConfig:e})=>{const{pathname:t}=ge();function n(r){return t.includes(r)}return s.jsxs(s.Fragment,{children:[s.jsx("ul",{className:H["tab-list"],children:e.map(r=>{if(!(r!=null&&r.default))return s.jsx("li",{className:f(H.tab,{[H.active]:n(r.linkPath)}),children:s.jsx(lt,{to:r.linkPath,children:r==null?void 0:r.tabText})},r.id)})}),s.jsx("div",{className:H.shadow,children:s.jsx(vt,{children:e.map(r=>s.jsx(R,{path:r==null?void 0:r.routePath,element:r.component},r.id))})})]})};function X(e,t){return e.find(n=>n.id===t)}const Ms=({data:e,patientsInfo:t})=>{const[n,r]=u.useState(""),[a,o]=u.useState([]);return u.useEffect(()=>{o(e.filter(i=>{var h;const c=X(t,i),d=(h=c==null?void 0:c.name)==null?void 0:h.toLowerCase(),b=n.toLowerCase();return d==null?void 0:d.includes(b)}))},[n,e,t]),{setSearchName:r,filteredData:a,searchName:n}},Fs=S("doctorSlice/addToOwnPatients",async(e,{getState:t,rejectWithValue:n,fulfillWithValue:r})=>{const a=g(),i=t().authentication.id,c=_(a,`doctors/${i}/my-patients/${e}`);if((await $(c)).exists())return r("already added");try{await A(c,!0)}catch{return n("something went wrong")}}),Bs=S("doctorSlice/doctorAnswer",async({userId:e,appointmentId:t,type:n},{getState:r,dispatch:a})=>{const i=r().authentication.id,c=g(),d=_(c,`users/${e}/appointments/${t}`),b=_(c,`doctors/${i}/appointments/${t}`);try{await it(d,{status:n}),await it(b,{status:n})}catch{a(E({text:"Упс, что-то пошло не так",type:"error"}))}}),Us="_wrapper_9nua0_3",Hs="_active_9nua0_35",qs="_title_9nua0_38",zs="_additional_9nua0_39",Ws="_time_9nua0_40",Ys="_icon_9nua0_66",Ks="_status_9nua0_73",Vs="_enrolled_9nua0_76",Gs="_admitted_9nua0_79",Qs="_accept_9nua0_120",Zs="_cancel_9nua0_126",j={wrapper:Us,"functional-btns-wrapper":"_functional-btns-wrapper_9nua0_29","btn-delete":"_btn-delete_9nua0_32",active:Hs,title:qs,additional:zs,time:Ws,icon:Ys,status:Ks,enrolled:Vs,admitted:Gs,"not-admitted":"_not-admitted_9nua0_82","functional-btn":"_functional-btn_9nua0_29",accept:Qs,cancel:Zs},Js=({id:e,userId:t})=>{const n=w();function r(a){t&&(a==="admitted"&&n(Fs(t)),n(Bs({userId:t,appointmentId:e,type:a})))}return s.jsxs("div",{className:j["functional-btns-wrapper"],children:[s.jsx("button",{className:f(j["functional-btn"],j.accept),onClick:()=>{r("admitted")},children:"Пациент принят"}),s.jsx("button",{className:f(j["functional-btn"],j.cancel),onClick:()=>{r("not-admitted")},children:"Пациент не пришел"})]})},Xs=({className:e,name:t,specialization:n})=>s.jsxs("span",{className:f(e),children:[s.jsx("h4",{className:j.title,children:t}),n&&s.jsx("p",{className:j.additional,children:n})]}),tn=S("appointments",async(e,{getState:t,dispatch:n})=>{const r=t(),a=r.authentication.id,o=r.authentication.rights,i=_(g(),`${o==="user"?"users":"doctors"}/${a}/appointments/${e}`);try{await be(i)}catch{n(E({text:"Не удалось удалить запись",type:"error"}))}}),en=({id:e})=>{const t=w();return s.jsx("button",{className:j["btn-delete"],onClick:()=>{t(tn(e))},children:s.jsx("img",{src:$t})})},sn=e=>({enrolled:"Записан",admitted:"Был принят","not-admitted":"Не принят",expired:"Запись просрочена"})[e],nn=e=>({enrolled:"Вы записаны",admitted:"Вы были приняты","not-admitted":"Вы не были приняты",expired:"Запись просрочена"})[e],rn=({status:e})=>s.jsxs("div",{className:f(j.status,j[e]),children:[s.jsx(G,{requiredRights:"admin",children:sn(e)}),s.jsx(G,{requiredRights:"user",children:nn(e)})]}),an="/assets/calendar-2620e6bf.svg",on="/assets/time-f0281237.svg",cn=(e,t)=>{if(!e)return[null,null];const[n,r]=u.useState(null),[a,o]=u.useState(null);return u.useEffect(()=>{const i=je(e).locale("ru"),c=i.format("D MMMM YYYY"),d=`${i.format("HH:mm")} - ${i.add(t.count,t.what).format("HH:mm")}`;r(c),o(d)},[e]),[n,a]},ln=({className:e,fullDateISO:t,textDate:n,textTime:r})=>{const[a,o]=cn(t,{count:30,what:"minutes"});return s.jsx("div",{className:f(j.time,e),children:s.jsxs("div",{children:[s.jsxs("span",{children:[s.jsx("img",{className:j.icon,src:an}),a||n]}),s.jsxs("span",{children:[s.jsx("img",{className:j.icon,src:on}),o||r]})]})})},x=({className:e,children:t,active:n,handleClick:r})=>s.jsx("div",{className:f(e,j.wrapper,{[j.active]:n}),style:{cursor:n==!1||n==!0?"pointer":""},onClick:()=>r==null?void 0:r(),children:t});x.About=Xs;x.TimeInfo=ln;x.DeleteBtn=en;x.Status=rn;x.AnswerBtns=Js;const dn="_list_15mih_15",un="_link_15mih_21",pn="_card_15mih_25",mn="_about_15mih_25",T={"search-input":"_search-input_15mih_3",list:dn,link:un,card:pn,about:mn},hn=()=>{const e=p(o=>o.doctorSlice.doctorPatients),t=p(o=>o.doctorSlice.usersInfo),{filteredData:n,searchName:r,setSearchName:a}=Ms({data:e,patientsInfo:t});return s.jsxs(s.Fragment,{children:[s.jsx("input",{className:T["search-input"],type:"text",value:r,onChange:o=>a(o.target.value),placeholder:"Введите имя пациента"}),s.jsx("ul",{className:T.list,children:n.map(o=>{const i=X(t,o);return i?s.jsx("li",{children:s.jsx(lt,{className:T.link,to:`/profile/my-patients/${o}`,children:s.jsx(x,{className:T.card,children:s.jsx(x.About,{className:T.about,name:i.name})})})},o):null})})]})},_n=({className:e=""})=>{const t=dt(),n=()=>{t(-1)},r={display:"flex",alignItems:"center",juctifyContent:"center",padding:"8px 20px 10px",backgroundColor:"white",color:"#006ed0",fontSize:"30px",lineHeight:"30px",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 -1px 4px rgba(0, 0, 0, 0.1)",transition:"background-color 0.3s ease"},a=()=>{n()};return s.jsx("button",{className:f(e),style:r,onClick:a,children:"←"})},fn="_btn_4tu26_3",xn={btn:fn},ee=({className:e,children:t,onClick:n})=>s.jsx("button",{className:f(e,xn.btn),onClick:n,children:t}),gn=({htmlContent:e,className:t})=>s.jsx("div",{className:f(t),dangerouslySetInnerHTML:{__html:e}}),bn="_record_6g619_1",jn="_name_6g619_6",Sn="_additional_6g619_11",P={record:bn,name:jn,additional:Sn,"report-header":"_report-header_6g619_17","html-wrapper":"_html-wrapper_6g619_35"},se=({record:e,doctorInfo:t})=>s.jsxs("div",{className:P.record,children:[s.jsxs("div",{className:P["report-header"],children:[s.jsx("h4",{className:P.name,children:t==null?void 0:t.name}),s.jsx("h5",{className:P.additional,children:t==null?void 0:t.specialization})]}),s.jsx(gn,{className:P["html-wrapper"],htmlContent:e.record})]},e.id);function ne(e,t){return e.find(n=>n.id===t)}const yn=({})=>{const e=p(n=>n.doctorSlice.medicalCard),t=p(n=>n.doctorSlice.doctorsInfo);return s.jsx("div",{className:P.container,children:e.map(n=>{const r=ne(t,n.doctorId);return s.jsx(se,{record:n,doctorInfo:r},n.id)})})},wn=({value:e,setValue:t})=>s.jsx(Se,{style:{height:"300px"},theme:"snow",value:e,onChange:t}),vn=S("doctorSlice/addRecordToCard",async(e,{getState:t,rejectWithValue:n})=>{const r=g(),a=_(r,`users-info/${e.patientId}/medical-records/${O()}`),i=t().authentication.id,c={...e,doctorId:i};try{await A(a,c)}catch{return n("error")}}),Dn="_title_1y3d6_5",In="_btn_1y3d6_15",k={"back-button":"_back-button_1y3d6_1",title:Dn,"btn-wrapper":"_btn-wrapper_1y3d6_15",btn:In,"loader-wrapper":"_loader-wrapper_1y3d6_24"},Nn=({patientId:e})=>{var c;const t=w(),n=p(d=>d.doctorSlice.isLoading),r=p(d=>d.doctorSlice.usersInfo),[a,o]=u.useState("");u.useEffect(()=>{t(L(e))},[]);function i(){const d={patientId:e,fullDateISO:y().toISOString(),record:a};o(""),t(vn(d)),t(L(e))}return s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(_n,{className:k["back-button"]}),s.jsxs("h2",{className:k.title,children:[s.jsx("span",{children:"Пациент:"})," ",(c=X(r,e))==null?void 0:c.name]})]}),s.jsx(wn,{value:a,setValue:o}),s.jsx("div",{className:k["btn-wrapper"],children:s.jsx(ee,{className:k.btn,onClick:i,children:"Добавить запись"})}),n?s.jsx("div",{className:k["loader-wrapper"],children:s.jsx(_t,{color:"#006ed0",size:40})}):s.jsx(yn,{patientId:e})]})},Cn="_wrapper_1m45x_1",$n={wrapper:Cn},Pn=({})=>{const{patientId:e}=ye();return s.jsx("div",{className:$n.wrapper,children:e?s.jsx(Nn,{patientId:e}):s.jsx(hn,{})})},An="/assets/arrow-60e4b77b.svg",Tn="_active_1v3fb_35",v={"profile-btn-container":"_profile-btn-container_1v3fb_3","profile-btn":"_profile-btn_1v3fb_3","profile-btn__name":"_profile-btn__name_1v3fb_14","profile-btn__arrow":"_profile-btn__arrow_1v3fb_17","profile-btn__submenu":"_profile-btn__submenu_1v3fb_22",active:Tn,"profile-btn__submenu-item":"_profile-btn__submenu-item_1v3fb_38"},kn=()=>{const e=p(o=>o.authentication.email),[t,n]=u.useState(!1),r=w(),a=u.useCallback(({target:o})=>{o instanceof HTMLElement&&(o.closest("."+v["profile-btn-container"])||n(i=>!i))},[]);return u.useEffect(()=>{if(!t){document.removeEventListener("click",a);return}return document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}},[t,a]),s.jsxs("div",{className:v["profile-btn-container"],children:[s.jsxs("button",{className:v["profile-btn"],onClick:()=>{n(!t)},children:[s.jsx("span",{className:v["profile-btn__name"],children:e}),s.jsx("img",{className:v["profile-btn__arrow"],src:An})]}),s.jsxs("ul",{className:`${v["profile-btn__submenu"]} ${t?v.active:""}`,children:[s.jsx("li",{className:v["profile-btn__submenu-item"],children:s.jsx("button",{children:"Параметры"})}),s.jsx("li",{className:v["profile-btn__submenu-item"],children:s.jsx("button",{onClick:()=>{r(W())},children:"Выход"})})]})]})},Rn="_header_1n6cy_3",rt={header:Rn,"header-content":"_header-content_1n6cy_7","header-title":"_header-title_1n6cy_12"},re=({title:e})=>s.jsx("div",{className:rt.header,children:s.jsx(F,{children:s.jsxs("div",{className:rt["header-content"],children:[s.jsx("h2",{className:rt["header-title"],children:e}),s.jsx(Zt,{children:s.jsx(kn,{})})]})})}),En="_btn_105nh_3",Ln="_active_105nh_24",q={"btns-wrapper":"_btns-wrapper_105nh_3","btn-wrapper":"_btn-wrapper_105nh_10",btn:En,active:Ln},On=({className:e,sortConfig:t,chosenFilter:n,handleClick:r})=>s.jsx("ul",{className:f(q["btns-wrapper"],e),children:t.map(a=>s.jsx("li",{className:q["btn-wrapper"],children:s.jsx("button",{className:f(q.btn,{[q.active]:n===a.filter}),onClick:()=>{r(a.filter)},children:a.btnText})},O()))});const ae=e=>s.jsx(we,{className:"react-calendar",...e}),oe=l.Union(l.InstanceOf(Date),l.Null),Mn=(e,t,n)=>{const[r,a]=u.useState(t),[o,i]=u.useState([]),c=d=>y(d.fullDateISO).startOf("day").toISOString()===n;return u.useEffect(()=>{i(r==="all"?e.filter(c):e.filter(d=>d.status===r).filter(c))},[r,n,e]),{handledList:o,chosenFilter:r,setChosenFilter:a}},Fn="_container_mtx6b_3",Bn="_number_mtx6b_14",Un="_active_mtx6b_21",Hn="_disabled_mtx6b_33",C={container:Fn,number:Bn,active:Un,"arrow-btn":"_arrow-btn_mtx6b_26",disabled:Hn},ie={activeClassName:C.active,disabledClassName:C.disabled,containerClassName:C.container,pageClassName:C.number,previousClassName:f(C["arrow-btn"],C["prev-btn"]),nextClassName:f(C["arrow-btn"],C["next-btn"])},ce=({page:e,countItemsOnPage:t,data:n})=>{const[r,a]=u.useState(e),[o,i]=u.useState([]);return u.useEffect(()=>void a(0),[n]),u.useEffect(()=>{i(n.filter((c,d)=>d>=r*t&&d<(r+1)*t))},[r,n]),{setCurrentPage:a,itemsToRender:o,currentPage:r}},qn="_message_5iue8_8",gt={"appointments-list":"_appointments-list_5iue8_3",message:qn},zn=({className:e,doctorAppointments:t})=>{const n=p(c=>c.doctorSlice.usersInfo),r=4,{itemsToRender:a,currentPage:o,setCurrentPage:i}=ce({data:t,countItemsOnPage:r,page:1});return s.jsxs("ul",{className:f(gt["appointments-list"],e),children:[a.map((c,d)=>{const b=X(n,c.userId);return Ue.guard(b)?s.jsx("li",{children:s.jsxs(x,{children:[c.status==="enrolled"&&s.jsx(x.AnswerBtns,{id:c.id,userId:c.userId}),s.jsx(x.About,{name:b.name}),s.jsx(x.TimeInfo,{fullDateISO:c.fullDateISO}),s.jsx(x.Status,{status:c.status})]})},c.id):s.jsx(u.Fragment,{},d)}),s.jsx(Dt,{forcePage:o,pageCount:Math.ceil(t.length/r),onPageChange:c=>i(c.selected),renderOnZeroPageCount:()=>s.jsx("p",{className:gt.message,children:!t.length&&"Нет записей за выбранную дату и сортировку"}),nextLabel:s.jsx(It,{}),previousLabel:s.jsx(Nt,{}),...ie})]})},Wn="_wrapper_xtoys_1",Yn="_calendar_xtoys_7",z={wrapper:Wn,calendar:Yn,"sort-btns-wrapper":"_sort-btns-wrapper_xtoys_19","appointment-list":"_appointment-list_xtoys_24"},Kn=[{filter:"all",btnText:"Все"},{filter:"enrolled",btnText:"Записанные"},{filter:"admitted",btnText:"Принятые"},{filter:"not-admitted",btnText:"Не принятые"},{filter:"expired",btnText:"Просроченные"}],Vn=({doctorAppointments:e})=>{const[t,n]=u.useState(y().startOf("day").toISOString()),{handledList:r,chosenFilter:a,setChosenFilter:o}=Mn(e,"all",t);return s.jsx(s.Fragment,{children:s.jsxs("div",{className:z.wrapper,children:[s.jsx(On,{className:z["sort-btns-wrapper"],sortConfig:Kn,chosenFilter:a,handleClick:o}),s.jsx(zn,{className:z["appointment-list"],doctorAppointments:r}),s.jsx(ae,{className:z.calendar,value:y(t).toDate(),onChange:i=>oe.guard(i)&&n(y(i).toISOString())})]})})},Gn=()=>{const e=p(n=>n.doctorSlice.appointments);let t=[{id:1,tabText:"Список записей",linkPath:`${m.profile.home}${m.profile.appointmentList}`,routePath:`${m.profile.appointmentList}`,component:s.jsx(Vn,{doctorAppointments:e})},{id:2,tabText:"Мои пациенты",linkPath:`${m.profile.home}${m.profile.myPatients}`,routePath:`${m.profile.myPatients}:patientId?`,component:s.jsx(Pn,{})},{id:3,linkPath:"",routePath:`${m.home}`,component:s.jsx(J,{to:`./${m.profile.appointmentList}`}),default:!0}];return s.jsxs(s.Fragment,{children:[s.jsx(re,{title:"Добро пожаловать"}),s.jsx(F,{children:s.jsx(te,{tabsConfig:t})})]})},Qn="_wrapper_13knd_3",Zn="_message_13knd_8",bt={wrapper:Qn,message:Zn},Jn=({})=>{const e=p(n=>n.patientSlice.medicalRecords),t=p(n=>n.patientSlice.doctorsInfo);return s.jsx("div",{className:bt.wrapper,children:e.length?e.map(n=>s.jsx(se,{record:n,doctorInfo:ne(t,n.doctorId)},n.id)):s.jsx("p",{className:bt.message,children:"У вас нет записей в медицинской карте"})})},Xn="_btn_x82fc_3",tr="_chosen_x82fc_27",at={"btns-wrapper":"_btns-wrapper_x82fc_3",btn:Xn,chosen:tr},le=({from:e,to:t,stepSize:n,busyDates:r})=>{const a=w(),o=p(Yt),i=p(ss),[c,d]=u.useState([]);u.useEffect(()=>{const h=[],I=y(o).hours(e.hours).minutes(e.minutes).seconds(0).milliseconds(0),B=y(I).hours(t.hours).minutes(t.minutes);for(;!I.isSameOrAfter(B);){const tt={text:I.format("HH:mm"),isDisabled:r.some(et=>et===I.toISOString())};h.push(tt),I.add(n.hours,"hours").add(n.minutes,"minutes")}d(h)},[e,t,n]);function b(h){a(pt({chosenTime:h}))}return s.jsx("div",{className:at["btns-wrapper"],children:c.map(h=>s.jsx("button",{className:f(at.btn,{[at.chosen]:h.text===i}),disabled:h.isDisabled,onClick:()=>{b(h.text)},children:h.text},O()))})};Ct.memo(le);const er="_title_g1ug0_3",ot={title:er,"content-container":"_content-container_g1ug0_14","record-calendary":"_record-calendary_g1ug0_28"},sr=()=>{const e=w(),t=p(ts),n=p(Yt),r=u.useMemo(()=>({from:{hours:8,minutes:0},to:{hours:17,minutes:0},stepSize:{hours:0,minutes:30},busyDates:t,chosenDate:n}),[t,n]);function a(o){oe.guard(o)&&o&&e(pt({chosenDate:o.toISOString()}))}return s.jsxs("div",{children:[s.jsx("h2",{className:ot.title,children:"Выберите дату и время"}),s.jsxs("div",{className:ot["content-container"],children:[s.jsx(ae,{className:ot["record-calendar"],maxDate:y().add(1,"month").toDate(),minDate:y().add(1,"day").toDate(),maxDetail:"month",minDetail:"year",value:n&&y(n).toDate(),onChange:o=>{a(o)},tileDisabled:({date:o,view:i})=>i==="month"&&(o.getDay()===0||o.getDay()===6)}),n&&s.jsx(le,{...r})]})]})},nr=S("appointments",async(e,{dispatch:t,rejectWithValue:n})=>{const r=_(g(),`doctors/${e}/appointments`);Z(r,a=>{const o=a.val();if(!a.exists())return t(ft([]));if(!ut.guard(o))return n("unknown type of doctor appointment data");const c=D(o).map(d=>d.fullDateISO);t(ft(c))})}),rr="_title_e74vm_3",jt={title:rr},ar=({doctorsInfo:e})=>{const t=w(),n=p(es);u.useEffect(()=>{n&&t(nr(n))},[n]);function r(a){t(pt({chosenDoctor:a}))}return s.jsxs("div",{children:[s.jsx("h2",{className:jt.title,children:"Выберите врача"}),s.jsx("ul",{className:jt["doctor-list"],children:e.map(a=>s.jsx("li",{children:s.jsxs(x,{active:n===a.id,handleClick:()=>r(a.id),children:[s.jsx(x.About,{name:a.name,specialization:a.specialization}),s.jsx(x.TimeInfo,{textDate:"Пн-Пт",textTime:"8:00-17:00"})]})},a.id))})]})},St={"content-wrapper":"_content-wrapper_1u7nq_3"},or=()=>{const e=w(),t=dt(),n=p(Wt),r=p(Xe);return u.useEffect(()=>{r&&(t(m.profile.home+m.profile.appointmentList),e(rs()))},[r]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:St["content-wrapper"],children:[s.jsx(ar,{doctorsInfo:n}),s.jsx(sr,{}),s.jsx(ee,{className:f(St.end),onClick:()=>{e(qt())},children:"Записаться"})]})})},ir="_message_5iue8_8",yt={"appointments-list":"_appointments-list_5iue8_3",message:ir},cr=({className:e,userAppointments:t})=>{const n=p(Wt),r=5,{itemsToRender:a,setCurrentPage:o}=ce({page:0,countItemsOnPage:r,data:t});return s.jsxs(s.Fragment,{children:[s.jsx("ul",{className:f(yt["appointments-list"],e),children:a.map(i=>{const c=n.find(d=>d.id===i.doctorId);return Le.guard(c)?s.jsx("li",{children:s.jsxs(x,{children:[s.jsx(x.About,{name:c.name,specialization:c.specialization}),s.jsx(x.TimeInfo,{fullDateISO:i.fullDateISO}),s.jsx(x.Status,{status:i.status}),s.jsx(x.DeleteBtn,{id:i.id})]})},i.id):s.jsx(u.Fragment,{},i.id)})}),s.jsx(Dt,{pageCount:Math.ceil(t.length/r),onPageChange:i=>o(i.selected),renderOnZeroPageCount:null,nextLabel:s.jsx(It,{}),previousLabel:s.jsx(Nt,{}),...ie}),!t.length&&s.jsx("p",{className:yt.message,children:"'У вас нет никаких записей'"})]})},lr=()=>{const e=p(n=>n.patientSlice.userAppointments),t=[{id:1,tabText:"Записаться",linkPath:m.profile.home+m.profile.makeAppointment,routePath:m.profile.makeAppointment,component:s.jsx(or,{})},{id:2,tabText:"Список записей",linkPath:m.profile.home+m.profile.appointmentList,routePath:m.profile.appointmentList,component:s.jsx(cr,{userAppointments:e})},{id:3,tabText:"Медицинская карта",linkPath:m.profile.home+"my-medical-card",routePath:"/my-medical-card",component:s.jsx(Jn,{})},{id:4,linkPath:"",routePath:"/",component:s.jsx(J,{to:m.profile.makeAppointment}),default:!0}];return s.jsxs(s.Fragment,{children:[s.jsx(re,{title:"Запишитесь на прием"}),s.jsx(F,{children:s.jsx(te,{tabsConfig:t})})]})},dr=()=>s.jsxs("div",{children:[s.jsx(G,{requiredRights:"user",children:s.jsx(lr,{})}),s.jsx(G,{requiredRights:"admin",children:s.jsx(Gn,{})})]}),ur="_title_1xg3z_16",wt={"signup-wrapper":"_signup-wrapper_1xg3z_3",title:ur},pr=()=>{const[e,t]=u.useState(""),n=w(),r=p(Vt),a=p(Gt);function o(i,c){n(K({email:i,password:c,name:e}))}return s.jsx(F,{children:s.jsxs("div",{className:wt["signup-wrapper"],children:[s.jsx("h3",{className:wt.title,children:"Регистрация"}),s.jsx(Xt,{submitHandler:o,submitBtnContent:r?s.jsx(_t,{size:24,color:"#fff"}):"Зарегистрироваться",error:a&&{type:a.type,message:a.message},children:s.jsx(ct,{type:"name",value:e,onChange:i=>t(i.target.value),placeholder:"ФИО",required:!0})}),s.jsx(Jt,{contentText:"Уже есть аккаунт?",linkText:"Войти",redirectPath:m.login,handleClick:()=>n(Qt())})]})})},mr=()=>{const e=w(),t=p(({authentication:r})=>r.isAuth),n=dt();return u.useEffect(()=>{let r=bs(e);return()=>void r()},[]),u.useEffect(()=>{t&&n(m.profile.home)},[t]),s.jsx(s.Fragment,{children:s.jsxs(vt,{children:[s.jsx(R,{path:m.home,element:s.jsx(J,{to:m.login})}),s.jsx(R,{path:m.login,element:s.jsx(Rs,{})}),s.jsx(R,{path:m.singUp,element:s.jsx(pr,{})}),s.jsx(R,{path:`${m.profile.home}*`,element:s.jsx(Zt,{children:s.jsx(dr,{})})})]})})},hr={apiKey:"AIzaSyDLCk35bsbIUHlSrrvkmWVb0OlLkEMRyBk",authDomain:"hospital-1651b.firebaseapp.com",projectId:"hospital-1651b",storageBucket:"hospital-1651b.appspot.com",messagingSenderId:"180699288079",appId:"1:180699288079:web:00e15fb90caaf4ca03c97a"},_r=ve(hr);De(M(_r),Ie);Ne.createRoot(document.getElementById("root")).render(s.jsx(Ct.StrictMode,{children:s.jsxs(Ce,{store:ds,children:[s.jsx(gs,{}),s.jsx($e,{children:s.jsx(mr,{})})]})}));
